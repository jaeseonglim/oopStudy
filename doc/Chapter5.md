# 책임 할당하기
- 데이터가 아닌 행동, 책임에 초점을 맞출 것.
- 어떤 객체에게 어떤 책임을 할당하지 어렵다.
    - GRASP 패턴을 이용한다면 응집도, 결합도, 캡슐화와 같은 다양한 기준에 따라 올바른 책임을 할당할 수 있게 될것이다.
- 협력이라는 문맥내에서 책임을 결정하라.
    - 책임은 **객체의 입장에서가 아닌** 객체가 참여하는 협력에 적합해야 한다.
    - **협력을 시작하는 주체는 메시지 전송자이다.**
    - 협력에 적합한 책임이란것은 메시지 전송자에게 적합한것을 의미한다.

- 메시지를 결정한 후에 객체를 선택하라. 
    - 메시지가 존재하기 때문에 메시지를 처리할 객체가 필요한 것.
    - 평소 해왔던 클래스 기반 설계를 메시지 기반 설계로 변경해보자.
    - 이 클래스가 필요하단걸 알겠는데 무엇을 해야하지? -> 메시지를 전송해야 하는데 누구에게 전송하지?

- 객체에게 적절한 책임을 할당하기 위해서는 협력이라는 문맥을 고려해야 한다. <br>
협력이라는 문맥에서 적절한 책임이란 클라이언트 관점에서 전송할 메시지를 결정한 후에
객체를 선택하고 내부데이터를 고민해야한다.    

## GRASP 패턴
- General Responsibility Assignment Software Patterns
1. Application에게 제공해야하는 기능을 어플리케이션의 책임으로 생각하고 메시지를 첫번째로 결정한다. <br>
    메시지 결정시 수신할 객체가 아닌 전송하는 객체의 의도를 반영하자.
    - 메시지를 전송하는 객체는 무엇을 원하는가?
2. 메시지를 수신할 적합한 객체를 선택한다.
    - 메시지를 수신할 적합한 객체는 누구인가?
    - 수신할 정보를 알고있는 객체를 선택한다. (정보 전문가 패턴) 
    - **책임을 수행할 객체가 정보를 알고있다고 해서 책임을 수행할 객체가 반드시 정보를 저장할 필요는 없다.** <br>
    해당 정보를 다른 객체를 통해 제공받을 수 있다.
3. 수신한 객체는 메시지 처리를 위해 필요한 절차와 구현을 고민해본다.
    - 처리할 수 없는 작업이 무엇인지 고민한 후 처리할 수 없는 작업은 외부에 요청한다.
    - 요청은 메시지가 된다.
4. 결과 인스턴스 (A객체)를 어떤 객체가 책임을 질것인지 판단한다.
    - Creator 패턴
        - B가 A를 포함하거나 의존할 경우
        - B가 A를 기록할 경우
        - B가 A를 사용할 경우
        - B가 A를 생성하는데 필요한 정보를 알고있는 경우
     - 생성되는 객체와 연결되거나 관련될 필요가 있는 객체에게 생성 책임을 맡긴다.

## DiscountCondition 개선하기
- 하나 이상의 변경 이유를 가진다면 응집도가 낮다.
- 서로 연관없는 기능이나 데이터가 하나의 클래스에 있는 의미이므로 <br>
**변경의 이유를 기준으로 클래스를 분리하자.**
<br>
<br>
- 변경의 조짐이 보이는 클래스 찾는 방법.
    1. 인스턴스 변수가 초기화 되는 시점
        - 일부만 초기화하고 일부는 초기화하지 않으면 서로 다른 시점에서 초기화가 된다는 것이므로<br>
        함께 초기화가 되는 속성 기준으로 코드를 분리해야 한다.
    2. 메서드들이 인스턴스 변수를 사용하는 방법.
        - 모든 메서드가 객체의 속성을 사용한다면 클래스 응집도가 높다고 볼 수 있다.
        - 메서드들이 사용하는 속성에 따라 그룹이 나뉜다면 클래스의 응집도가 낮다.
        - 응집도를 높히기 위해서는 속성 그룹과 해당 속성들에 접근하는 메서드 그룹 기준으로 코드를 분리한다.

## 다형성을 통해 분리           
- 할인여부를 판단하는 SequenceCondition, PeriodCondition이 동일한 책임을 수행한다는 것은 <br>
동일한 역할을 수행한다는 것이다.
- 역할은 협력안에서 대체 가능성을 의미한다.
- 구현 클래스를 알지 못한채 역할에 대해서만 결합되도록 추상화하여 의존성을 낮게 한다.
- **객체의 타입에 따라 변하는 행동이 있다면 타입을 분리하고 변화하는 행동을 각 타입의 책임으로 할당하자.**

## 변경으로부터 보호하기
- 변경보호 패턴
    - 변화가 예상되는 불안정한 지점들을 식별하고 주위에 안정된 인터페이스를 형성하여 변하는 개념을 캡슐화한다.

## Movie 클래스 개선하기
- 도메인의 구조가 코드의 구조를 이룬다.
- OOP는 도메인의 개념과 구조를 코드로써 반영을 가능하게 만든다.

## 변경과 유연성
- Movie에 설정된 할인 정책을 실행에 반영할 수 있어야 한다는 요구사항이 추가 되었을 경우 <br>
할인정책을 상속을 통해 구현하고 있으므로 새 인스턴스를 생성해야 한다.
- 상속 대신 합성을 이용하자.
- 도메인 모델은 단순히 도메인의 개념과 관계를 모아 놓은것이 아닌 구현의 기반이다.

